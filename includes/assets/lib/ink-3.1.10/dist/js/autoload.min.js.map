{"version":3,"sources":["../../src/js/Ink/Autoload/1/lib.js"],"names":["Ink","createModule","Selector","InkArray","Loaded","Scroller","Close","Drawer","validSelector","sel","select","el","e","error","document","createElement","Autoload","selectors","DatePicker_1","FormValidator_2","Modal_1","Table_1","Tabs_1","Tooltip_1","defaultOptions","run","parentEl","options","findElements","mod","fname","test","split","modName","elements","filter","autoloadElement","length","requireModules","Component","forEach","getInstance","element","forceAutoload","getAttribute","extendObj","hasOwnProperty","createClose","createSmoothScroller","init","createDrawer","matchesSelector","body","add","moduleName","selector","remove","k","window","INK_NO_AUTO_LOAD","firstRunDone"],"mappings":"AAKAA,IAAIC,aAAa,eAAgB,GAAI,qBAAsB,mBAAoB,mBAAoB,0BAA2B,iBAAkB,mBAAoB,SAAUC,EAAUC,EAAUC,EAAQC,EAAUC,EAAOC,GACvN,YASA,SAASC,GAAcC,GACnB,IACIP,EAASQ,OAAOD,EAAKE,GACvB,MAAMC,GAEJ,MADAZ,KAAIa,MAAMD,IACH,EAEX,OAAO,EATX,GAAID,GAAKG,SAASC,cAAc,OAY5BC,GAOAC,WAKIC,aAAkB,kBAKlBC,gBAAoB,qBAGpBC,QAAkB,aAMlBC,QAAkB,aAClBC,OAAkB,YAElBC,UAAkB,0BAGtBC,kBAkBAC,IAAK,SAAUC,EAAUC,GA2BrB,QAASC,GAAaC,GAClB,GAAIC,EACA,MAAKC,KAAKF,KACVA,EAAMA,EAAIG,MAAM,KAChBF,EAAQD,EAAI,GACZA,EAAMA,EAAI,GAEd,IAAII,GAAU,UAAYJ,EACtBK,EAAWhC,EAASQ,OAAQiB,EAAQV,UAAUY,GAAMH,EAExDQ,GAAW/B,EAASgC,OAAOD,EAAUE,GAEjCF,EAASG,QACTrC,IAAIsC,gBAAiBL,GAAU,SAAUM,GACrCpC,EAASqC,QAAQN,EAAU,SAAUvB,IACI,kBAA1B4B,GAAUE,aACgB,MAA7BF,EAAUE,YAAY9B,MAGzBmB,EAGDS,EAAUT,GAAOnB,EAAIK,EAASQ,eAAeK,IAF7C,GAAIU,GAAU5B,EAAIK,EAASQ,eAAeK,SAS9D,QAASO,GAAgBM,GACrB,MAAIf,GAAQgB,iBAAkB,GAAe,EACT,kBAAzBD,GAAQE,cAA+D,gBAAzBF,GAAQE,aACZ,UAA1CF,EAAQE,aAAa,iBADhC,OAzDJjB,EAAU3B,IAAI6C,WAMV5B,UAAWD,EAASC,WACrBU,MAEH,KAAI,GAAIE,KAAOF,GAAQV,UAAeU,EAAQV,UAAU6B,eAAejB,IAEnED,EAAaC,EAEbF,GAAQoB,eAAgB,GACxB,GAAIzC,GAEJqB,EAAQqB,wBAAyB,GACjC3C,EAAS4C,OAETtB,EAAQuB,gBAAiB,KACrBhD,EAASiD,gBAAgBrC,SAASsC,KAAM,gBAClC7C,EAAOkC,aAAelC,EAAOkC,YAAY3B,SAASsC,OACxD,GAAI7C,GAAOO,SAASsC,QAgDhCC,IAAK,SAAUC,EAAYC,GACvB,MAAK/C,GAAc+C,QAEfvC,EAASC,UAAUqC,GACnBtC,EAASC,UAAUqC,IAAe,KAAOC,EAEzCvC,EAASC,UAAUqC,GAAcC,IALE,GAe3CC,OAAQ,SAAUF,SACPtC,GAASC,UAAUqC,IAIlC,KAAK,GAAIG,KAAKzC,GAASC,UAAeD,EAASC,UAAU6B,eAAeW,KACpEzC,EAASQ,eAAeiC,MAa5B,OAVKC,QAAOC,kBACRvD,EAAOqB,IAAI,WACPT,EAASS,IAAIX,UACTkC,sBAAsB,EACtBD,aAAa,IAEjB/B,EAAS4C,cAAe,IAIzB5C","file":"autoload.min.js","sourcesContent":["/** \n * @module Ink.Autoload\n * @version 1\n * Create Ink UI components easily\n */\nInk.createModule('Ink.Autoload', 1, ['Ink.Dom.Selector_1', 'Ink.Util.Array_1', 'Ink.Dom.Loaded_1', 'Ink.UI.SmoothScroller_1', 'Ink.UI.Close_1', 'Ink.UI.Drawer_1'], function( Selector, InkArray, Loaded, Scroller, Close, Drawer ){\n    'use strict';\n\n    /**\n     * @namespace Ink.Autoload\n     * @static\n     */\n\n    var el = document.createElement('div');\n    // See if a selector is valid.\n    function validSelector(sel) {\n        try {\n            Selector.select(sel, el);\n        } catch(e) {\n            Ink.error(e);\n            return false;\n        }\n        return true;\n    }\n\n    var Autoload = {\n        /**\n         * Matches module names to default selectors.\n         * \n         * @property selectors {Object}\n         * @public\n         **/\n        selectors: {\n            /* Match module names to element classes (or more complex selectors)\n             * which get the UI modules instantiated automatically. */\n            // 'Animate_1'     : '.wcv-animate',\n            // 'Carousel_1'    : '.wcv-carousel',\n            'DatePicker_1'  : '.wcv-datepicker',\n            // 'DragDrop_1'    : '.wcv-dragdrop',\n            // 'Draggable_1'   : '.wcv-draggable',\n            // 'Dropdown_1'    : '.wcv-dropdown',\n            // 'Droppable_1.add' : '.wcv-droppable',\n            'FormValidator_2' : '.wcv-formvalidator',\n            // 'Gallery_1'     : 'ul.wcv-gallery-source',\n            // 'LazyLoad_1'    : '.wcv-lazyload',\n            'Modal_1'       : '.wcv-modal',\n            // 'ProgressBar_1' : '.wcv-progress-bar',\n            // 'SortableList_1': '.wcv-sortable-list',\n            // 'Spy_1'         : '[data-spy=\"true\"]',\n            // 'Stacker_1'     : '.wcv-stacker',\n            // 'Sticky_1'      : '.wcv-sticky, .sticky',\n            'Table_1'       : '.wcv-table',\n            'Tabs_1'        : '.wcv-tabs',\n            // 'Toggle_1'      : '.wcv-toggle, .toggle',\n            'Tooltip_1'     : '.wcv-tooltip, .tooltip',\n            // 'TreeView_1'    : '.wcv-tree-view'\n        },\n        defaultOptions: {},\n\n        /**\n         * Run Autoload on a specific element.\n         *\n         * Useful when you load something from AJAX and want it to have automatically loaded Ink modules.\n         * @method run\n         * @param {Element} parentEl Root element. The children of this element will be processed by Autoload.\n         * @param {Object}  [options] Options object, containing:\n         * @param {Boolean} [options.forceAutoload] Autoload things on elements even if they have `data-autoload=\"false\"`\n         * @param {Boolean} [options.createClose] Whether to create the Ink.UI.Close component. Defaults to `true`.\n         * @param {Boolean} [options.createSmoothScroller] Whether to create the Scroller component. Defaults to `true`.\n         * @param {Object} [options.selectors=Ink.Autoload.selectors] A hash mapping module names to selectors that match elements to load these modules. For example, `{ 'Modal_1': '.my-specific-modal' }`.\n         * @param {Boolean} [options.waitForDOMLoaded=false] Do nothing until the DOM is loaded. Uses Ink.Dom.Loaded.run();\n         * @return {void}\n         * @public\n         * @sample Autoload_1.html\n         **/\n        run: function (parentEl, options){\n            options = Ink.extendObj({\n                // The below lines are not required because undefined is falsy anyway..\n                // forceAutoload: false,\n                // waitForDOMLoaded: false,\n                // createClose: false,\n                // createSmoothScroller: false,\n                selectors: Autoload.selectors\n            }, options || {});\n\n            for(var mod in options.selectors) if (options.selectors.hasOwnProperty(mod)) {\n                // `elements` need to be in a closure because requireModules is async.\n                findElements(mod);\n            }\n            if (options.createClose !== false) {\n                new Close();\n            }\n            if (options.createSmoothScroller !== false) {\n                Scroller.init();\n            }\n            if (options.createDrawer !== false) {\n                if (Selector.matchesSelector(document.body, '.ink-drawer') &&\n                        !(Drawer.getInstance && Drawer.getInstance(document.body))) {\n                    new Drawer(document.body);\n                }\n            }\n\n            function findElements(mod) {\n                var fname;\n                if (/\\./.test(mod)) {  // Droppable.add(elm, options)\n                    mod = mod.split('.');\n                    fname = mod[1];\n                    mod = mod[0];\n                }\n                var modName = 'Ink.UI.' + mod;\n                var elements = Selector.select( options.selectors[mod], parentEl );\n\n                elements = InkArray.filter(elements, autoloadElement);\n\n                if( elements.length ){\n                    Ink.requireModules( [modName], function( Component ) {\n                        InkArray.forEach(elements, function (el) {\n                            if (typeof Component.getInstance === 'function' &&\n                                    Component.getInstance(el) != null) {\n                                return; // Avoid multiple instantiation.\n                            }\n                            if (!fname) {\n                                new Component(el, Autoload.defaultOptions[mod]);\n                            } else {\n                                Component[fname](el, Autoload.defaultOptions[mod]);\n                            }\n                        });\n                    });\n                }\n            }\n\n            function autoloadElement(element) {\n                if (options.forceAutoload === true) { return true; }\n                if (typeof element.getAttribute === 'function' || typeof element.getAttribute === 'object') {\n                    return element.getAttribute('data-autoload') !== 'false';\n                }\n            }\n        },\n        /**\n         * Add a new entry to be autoloaded.\n         * @method add\n         * @param {String} moduleName The module name (Example: 'Modal_1', or 'Dropdown_1')\n         * @param {String} selector   A selector which finds elements where this module should be autoloaded (Example: '.my-modal' or '.my-dropdown')\n         * @return {void}\n         * @public\n         */\n        add: function (moduleName, selector) {\n            if (!validSelector(selector)) { return false; }\n\n            if (Autoload.selectors[moduleName]) {\n                Autoload.selectors[moduleName] += ', ' + selector;\n            } else {\n                Autoload.selectors[moduleName] = selector;\n            }\n        },\n        /**\n         * Removes a module from autoload, making it not be automatically loaded.\n         * @method remove\n         * @param {String} moduleName The module's name and version ('Name_ver')\n         * @return {void}\n         * @public\n         **/\n        remove: function (moduleName) {\n            delete Autoload.selectors[moduleName];\n        }\n    };\n\n    for (var k in Autoload.selectors) if (Autoload.selectors.hasOwnProperty(k)) {\n        Autoload.defaultOptions[k] = {};\n    }\n\n    if (!window.INK_NO_AUTO_LOAD) {\n        Loaded.run(function () {\n            Autoload.run(document, {\n                createSmoothScroller: true,\n                createClose: true\n            });\n            Autoload.firstRunDone = true;\n        });\n    }\n\n    return Autoload;\n});\n\n"]}